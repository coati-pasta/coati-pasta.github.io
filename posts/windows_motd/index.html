<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Windows PSSession MOTD" /><meta property="og:locale" content="en" /><meta name="description" content="Setting up a completely new windows environment comes with some one time configurations. One of those is legal notice texts and banners. Aside from the usual legalnotice text registry key, which only sets a legal message for Remote Desktop Connections. There is also a way to configure MOTD banners when connecting over Winrm to a windows host in powershell (Enter-PSSession)." /><meta property="og:description" content="Setting up a completely new windows environment comes with some one time configurations. One of those is legal notice texts and banners. Aside from the usual legalnotice text registry key, which only sets a legal message for Remote Desktop Connections. There is also a way to configure MOTD banners when connecting over Winrm to a windows host in powershell (Enter-PSSession)." /><link rel="canonical" href="https://coati-pasta.github.io/posts/windows_motd/" /><meta property="og:url" content="https://coati-pasta.github.io/posts/windows_motd/" /><meta property="og:site_name" content="Coati’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-13T10:30:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Windows PSSession MOTD" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Windows PSSession MOTD","dateModified":"2021-12-14T09:52:55+01:00","datePublished":"2021-12-13T10:30:00+01:00","description":"Setting up a completely new windows environment comes with some one time configurations. One of those is legal notice texts and banners. Aside from the usual legalnotice text registry key, which only sets a legal message for Remote Desktop Connections. There is also a way to configure MOTD banners when connecting over Winrm to a windows host in powershell (Enter-PSSession).","url":"https://coati-pasta.github.io/posts/windows_motd/","mainEntityOfPage":{"@type":"WebPage","@id":"https://coati-pasta.github.io/posts/windows_motd/"},"@type":"BlogPosting","@context":"https://schema.org"}</script><title>Windows PSSession MOTD | Coati's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Coati's blog"><meta name="application-name" content="Coati's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/coati-avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Coati's blog</a></div><div class="site-subtitle font-italic">This is my blog, there are many like it, but this one is mine.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/coati-pasta" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Windows PSSession MOTD</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Windows PSSession MOTD</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> coati-pasta </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Dec 13, 2021, 10:30 AM +0100" >Dec 13, 2021<i class="unloaded">2021-12-13T10:30:00+01:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 14, 2021, 9:52 AM +0100" >Dec 14, 2021<i class="unloaded">2021-12-14T09:52:55+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2067 words">11 min read</span></div></div><div class="post-content"><p>Setting up a completely new windows environment comes with some one time configurations. One of those is legal notice texts and banners. Aside from the usual legalnotice text registry key, which only sets a legal message for Remote Desktop Connections. There is also a way to configure MOTD banners when connecting over Winrm to a windows host in powershell (Enter-PSSession).</p><p>Here’s an example of what it might look like: <img data-proofer-ignore data-src="/assets/motd/motd_example.png" alt="image" /></p><h2 id="set-up">Set up</h2><p>To have a nice banner as shown in the screenshot above. We need the following:</p><ol><li>Environment variables, useful info to show upon startup<li>Ensure the presence of the banner startup script<li>Set the remote session configuration</ol><p>For the sake of being generic let’s say we decide on a <strong>motd_path</strong> filepath, which can be interpreted as: ‘C:\whereveryouwant\motd'. In the environment for which I configured this we are using Puppet as a configuration manager. But I suppose this could be translated to any other configuration manager.</p><p> </p><h2 id="1-environment-variables">1. Environment variables</h2><p>Aside from a nice logo that is shown, we would like to see some useful information concerning the machine you are connecting to. This could be the machine name, ip address, current disk space used, full FQDN, status of certain services. The needs may differ here, change at will.</p><p>In my case I use a configuration manager to ensure the presence of a PowerShell Datafile (.psd1) in the motd_path, parsed with some environment variables. Using the .psd1 format allows us to import the file in PowerShell as nice hashtable. Since I’m using puppet at this time, I am putting this file as a ruby template in a module (applied on the machine). Which will parse the variables in between the ‘&lt;%= %&gt;’ with machine variables and facts. The psd1 file looks something like:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span text-data=" Powershell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="p">@{</span><span class="w">
    </span><span class="nx">someInfo1</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @someInfo1 %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">someInfo2</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @someInfo2 %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">someInfo3</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @someInfo3 %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">someInfo4</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @someInfo4 %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">someInfo5</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @someInfo5 %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">Datacenter</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @env_dc %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">someInfo6</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @someInfo6 %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="s1">'AD Domain'</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @ad_domain %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">Domain</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @domain %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">OS</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @windows_product_name %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">Hostname</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @hostname %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="s1">'Server Type'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @operatingsystemtype %&gt;'</span><span class="p">;</span><span class="w">
    </span><span class="nx">someInfo9</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s1">'&lt;%= @environment %&gt;'</span><span class="p">;</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>The .psd1 will be imported in to a variable used throughout the nexts script to put the info in the right place. I can imagine that this can be reworked to contain perhaps performance metrics or anything really.</p><p> </p><h2 id="2-startupscsript">2. Startupscsript</h2><p>Now for the second file we need to have in the motd_path. This is the actual script that will run at startup to display the banner. A couple of things to note:</p><ul><li><p><strong>Save the file as UTF8 With BOM</strong>. If this is not done, the characters for the borders will be all messed up because of incompatible file encoding.</p><li><p>When importing the psd1 file, I’m again parsing a Ruby variable in puppet to ensure to have the correct path. This could be replaced with some declaration on where the script is located (something like “$ScriptPath = Split-Path $MyInvocation.MyCommand.Path”)</p><li><p>In the beginning of the script (the switch statement) I’m deciding whether or not to show the logo because of screen size constraints. I thought it’d be nice to have scaling responsive message. And if the console size is ridiculously small, i’m resorting to a simple echo of the legalnotice text.</p></ul><div class="language-powershell highlighter-rouge"><div class="code-header"> <span text-data=" Powershell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
</pre><td class="rouge-code"><pre><span class="c">## ATTENTION ::  This file needs to be saved with encoding UTF8 With BOM !!! otherwise special characters will not be loaded properly</span><span class="w">
</span><span class="c">## Dependency :: In the specified MOTD Path there needs to be a MOTDVars.psd1 file which contains a hashtable of environment variables!</span><span class="w">

</span><span class="c">#region setVariables</span><span class="w">
</span><span class="c"># Assign static variables based on banner size</span><span class="w">
</span><span class="kr">switch</span><span class="w"> </span><span class="p">(</span><span class="bp">$Host</span><span class="o">.</span><span class="nf">UI</span><span class="o">.</span><span class="nf">RawUI</span><span class="o">.</span><span class="nf">WindowSize</span><span class="o">.</span><span class="nf">Width</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="p">{</span><span class="bp">$_</span><span class="w"> </span><span class="o">-ge</span><span class="w"> </span><span class="mi">97</span><span class="p">}{</span><span class="w">
        </span><span class="nv">$drawBox</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
        </span><span class="nv">$windowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
        </span><span class="nv">$top_banner</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="sh">@"
                                    ╭──────────────────────────╮
    ╒═══════════════════════════════╡       ⚠  Warning ⚠      ╞═══════════════════════════════╕
    │                               ╰──────────────────────────╯                               │
    │                                                                                          │
    │                      Access is restricted to authorised users ONLY.                      │
    │                      All connections and transactions are monitored.                     │
    │               By continuing past this point, you consent to this monitoring.             │
    │                                                                                          │
"@</span><span class="w">
            </span><span class="nv">$div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sh">@"
    ├──────────────────────────────────────────────────────────────────────────────────────────┤
"@</span><span class="w">
            </span><span class="nv">$spacer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'    │  '</span><span class="w">
            </span><span class="nv">$width</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">$div</span><span class="o">.</span><span class="nf">length</span><span class="w">
            </span><span class="nv">$foot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'    └'</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'─'</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nv">$width</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'┘'</span><span class="w">
            </span><span class="nv">$limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">34</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">{</span><span class="bp">$_</span><span class="w"> </span><span class="o">-ge</span><span class="w"> </span><span class="mi">54</span><span class="w"> </span><span class="o">-AND</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">97</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nv">$drawBox</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
            </span><span class="nv">$top_banner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sh">@"
            ╭──────────────────────────────╮
    ╒═══════╡        ⚠   Warning ⚠        ╞═══════╕
    │       ╰──────────────────────────────╯       │
    │                                              │
    │    Access is restricted to authorised        │
    │    users ONLY. All transactions and          │
    │    connections are monitored.                │
    │    By continuing past this point, you        │
    │    consent to this monitoring.               │
    │                                              │
"@</span><span class="w">
            </span><span class="nv">$div</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sh">@"
    ├──────────────────────────────────────────────┤
"@</span><span class="w">
            </span><span class="nv">$width</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">$div</span><span class="o">.</span><span class="nf">length</span><span class="w">
            </span><span class="nv">$spacer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'    │    '</span><span class="w">
            </span><span class="nv">$foot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'    └'</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'─'</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nv">$width</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'┘'</span><span class="w">
            </span><span class="nv">$limit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">29</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="p">{</span><span class="bp">$_</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="mi">54</span><span class="p">}</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"!! Warning !!"</span><span class="w">
            </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Access is restricted to authorised users ONLY. All connections and transactions are monitored. By continuing past this point, you consent to this monitoring."</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="c">#import device info</span><span class="w">
    </span><span class="c">## Import MOTDVars.psD1    </span><span class="w">
    </span><span class="nv">$import</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Import-PowerShellDataFile</span><span class="w">  </span><span class="s1">'&lt;%= @motd_path %&gt;\motdVars.psd1'</span><span class="p">;</span><span class="w"> </span><span class="nv">$motdVars</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="p">@{};</span><span class="w"> </span><span class="nv">$import</span><span class="o">.</span><span class="nf">Keys</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$import</span><span class="o">.</span><span class="bp">$_</span><span class="o">.</span><span class="nf">length</span><span class="w"> </span><span class="o">-gt</span><span class="w"> </span><span class="nv">$limit</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$motdVars</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'error::var_too_long'</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$motdVars</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$import</span><span class="err">.</span><span class="bp">$_</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="nv">$Date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Date</span><span class="w">
    </span><span class="nv">$env_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">switch</span><span class="w"> </span><span class="p">(</span><span class="nv">$motdVars</span><span class="o">.</span><span class="nf">someInfo9</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s1">'dev'</span><span class="w">         </span><span class="p">{</span><span class="w"> </span><span class="s2">"DarkGreen"</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="s1">'staging'</span><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="s2">"DarkBlue"</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="s1">'production'</span><span class="w">  </span><span class="p">{</span><span class="w"> </span><span class="s2">"Red"</span><span class="w"> </span><span class="p">}</span><span class="w">
        </span><span class="n">Default</span><span class="w">       </span><span class="p">{</span><span class="w"> </span><span class="s2">"Yellow"</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="nv">$body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
        </span><span class="mi">1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"                        "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Black'</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"                  "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Black'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                                  </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">''</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">2</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"         ,.=:^!^!t3Z3z.,"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"                  "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Blue'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                                   </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nv">$Date</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="nv">$env_color</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">3</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"        :tt:::tt333EE3 "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w"> </span><span class="p">}</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"                   "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Black'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                                 </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">''</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s1">'Black'</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">4</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"        Et:::ztt33EEE "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" @Ee.,      ..,     "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                                </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'Hostname'</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">5</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"       ;tt:::tt333EE7"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w"> </span><span class="p">}</span><span class="w">     </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" ;EEEEEEttttt33#     "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                               </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'OS'</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">6</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"      :Et:::zt333EEQ."</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w"> </span><span class="p">}</span><span class="w">     </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" SEEEEEttttt33QL     "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                               </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'Server Type'</span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">7</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"      it::::tt333EEF"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w"> </span><span class="p">}</span><span class="w">      </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" @EEEEEEttttt33F      "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                              </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">''</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s1">'Black'</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">8</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"     ;3=*^</span><span class="se">``````</span><span class="s2">'*4EEV"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" :EEEEEEttttt33@.      "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                             </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'someInfo1'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">9</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"     ,.=::::it=., "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">       </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"</span><span class="se">``</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Red'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s2">" @EEEEEEtttz33QF       "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                      </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'someInfo2'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"    ;::::::::zt33) "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">      </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"  '4EEEtttji3P*        "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                             </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'someInfo3'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"   :t::::::::tt33."</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">       </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">":Z3z.. "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="s2">" </span><span class="se">````</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Green'</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s2">" ,..g.        "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">    </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'someInfo4'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"   i::::::::zt33F"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">        </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" AEEEtttt::::ztF         "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                          </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">''</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s1">'Black'</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"  ;:::::::::t33V"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">         </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" ;EEEttttt::::t3          "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                         </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'someInfo5'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"  E::::::::zt33L"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">         </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" @EEEtttt::::z3F          "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                         </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'Datacenter'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" {3=*^</span><span class="se">``````</span><span class="s2">'*4E3)"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">       </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" ;EEEtttt:::::tZ</span><span class="se">``</span><span class="s2">          "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                       </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'someInfo6'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"             </span><span class="se">``</span><span class="s2">"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Cyan'</span><span class="w"> </span><span class="p">}</span><span class="w">          </span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">" :EEEEtttt::::z7            "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                       </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'AD Domain'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"                 'VEzjt:;;z&gt;*</span><span class="se">``</span><span class="s2">            "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                                                       </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">'someInfo9'</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="w">   </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
        </span><span class="mi">18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">WindowsLogo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s2">"                      </span><span class="se">````</span><span class="s2">                  "</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Yellow'</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="p">}</span><span class="w">                                                                      </span><span class="p">;</span><span class="w"> </span><span class="nx">Info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="s1">''</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s1">'Black'</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="c">#endregion setvariables</span><span class="w">
</span><span class="c"># Write Actual Banner</span><span class="w">
</span><span class="kr">if</span><span class="p">(</span><span class="nv">$drawBox</span><span class="p">){</span><span class="w">
    </span><span class="n">write-host</span><span class="w"> </span><span class="nv">$top_banner</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nv">$env_color</span><span class="w">
    </span><span class="n">write-host</span><span class="w"> </span><span class="nv">$div</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nv">$env_color</span><span class="w">
    </span><span class="c">## write body</span><span class="w">
    </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="nv">$i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="nv">$i</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="nv">$body</span><span class="o">.</span><span class="nf">Count</span><span class="p">;</span><span class="w"> </span><span class="nv">$i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$lineLength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="n">Write-Host</span><span class="w"> </span><span class="nv">$spacer</span><span class="w"> </span><span class="nt">-NoNewline</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nv">$env_color</span><span class="w">
        </span><span class="kr">if</span><span class="p">(</span><span class="nv">$windowsLogo</span><span class="p">){</span><span class="w">
            </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="nv">$x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="nv">$x</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="nv">$body</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nf">WindowsLogo</span><span class="o">.</span><span class="nf">Keys</span><span class="o">.</span><span class="nf">Count</span><span class="p">;</span><span class="w"> </span><span class="nv">$x</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nv">$body</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nf">WindowsLogo</span><span class="o">.</span><span class="nv">$x</span><span class="o">.</span><span class="nf">Keys</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> 
                    </span><span class="n">Write-host</span><span class="w"> </span><span class="bp">$_</span><span class="w"> </span><span class="nt">-NoNewline</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nv">$body</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nf">WindowsLogo</span><span class="o">.</span><span class="nv">$x</span><span class="o">.</span><span class="bp">$_</span><span class="w"> 
                    </span><span class="nv">$lineLength</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">length</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="nv">$body</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nf">Info</span><span class="o">.</span><span class="nf">Keys</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nv">$info_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="si">$(</span><span class="bp">$_</span><span class="si">)$(</span><span class="kr">if</span><span class="p">(</span><span class="nv">$motdVars</span><span class="o">.</span><span class="bp">$_</span><span class="si">)</span><span class="s2">{': '})"</span><span class="w">
            </span><span class="nv">$info_var</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="si">$(</span><span class="nv">$motdVars</span><span class="o">.</span><span class="bp">$_</span><span class="si">)</span><span class="s2">"</span><span class="w">
            </span><span class="n">Write-host</span><span class="w"> </span><span class="nv">$info_key</span><span class="w"> </span><span class="nt">-NoNewline</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nv">$body</span><span class="o">.</span><span class="nv">$i</span><span class="o">.</span><span class="nf">Info</span><span class="o">.</span><span class="bp">$_</span><span class="w">
            </span><span class="n">Write-host</span><span class="w"> </span><span class="nv">$info_var</span><span class="w"> </span><span class="nt">-NoNewline</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Gray</span><span class="w">
            </span><span class="nv">$lineLength</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="nv">$info_key</span><span class="o">.</span><span class="nf">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$info_var</span><span class="o">.</span><span class="nf">length</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"</span><span class="si">$(</span><span class="s1">' '</span><span class="o">*</span><span class="p">(</span><span class="nv">$width</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">$spacer</span><span class="o">.</span><span class="nf">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">$lineLength</span><span class="w"> </span><span class="nt">-1</span><span class="si">)</span><span class="s2"> + '│')"</span><span class="w">  </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nv">$env_color</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="p">(</span><span class="s2">"</span><span class="nv">$foot</span><span class="s2">"</span><span class="p">)</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nv">$env_color</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><strong>Note:</strong> I have to disclaim that I found the windows logo on <a href="https://github.com/joeyaiello/ps-motd">GitHub</a>, credit where credit is due. I decided to rewrite it abit to have the logo in a hashtable together with the session info. And to build the banner with the nested loops. My thought was that it’s shorter, nicer and more readable. However using nested loops like that my come with some performance impact. Maybe it’s a bit harder on the cpu when the script runs. I found when testing that it was not that bad of a delay compared to using the millions of write-host statements. Depends on the case and what you prefer.</p><p> </p><h2 id="3-set-pssessionconfiguration">3. Set-PSSessionConfiguration</h2><p>Now that we have all the necessary files in place, we need to configure the machine to run the motd.ps1 script on startup of a Remote Session. We need to point the PSSessionConfiguration for the microsoft.powershell profile to the startupscript, or create a new profile. Again depends on the use case.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span text-data=" Powershell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c">#decide if config needs to be set</span><span class="w">
</span><span class="kr">if</span><span class="p">((</span><span class="n">Get-PSSessionConfiguration</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s1">'microsoft.powershell'</span><span class="p">)</span><span class="o">.</span><span class="nf">startupscript</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="s1">'$($motd_path)\\motd.ps1'</span><span class="p">){</span><span class="w">
    </span><span class="c"># Set the config</span><span class="w">
    </span><span class="n">Set-PSSessionConfiguration</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'microsoft.powershell'</span><span class="w"> </span><span class="nt">-startupscript</span><span class="w"> </span><span class="s1">'${motd_path}\\motd.ps1'</span><span class="w"> </span><span class="nt">-NoServiceRestart</span><span class="w">
</span><span class="p">}</span><span class="kr">else</span><span class="p">{</span><span class="w">
    </span><span class="kr">exit</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>I prefer to put the NoServiceRestart when setting the configuration because when testing in my environment I found that setting the startupscript in this case did not require the pssesion (winrm) service to restart. <strong>Warning: if you do not specify the argument NoServiceRestart, the winrm service will restart and all current remote session will be disconnected…</strong></p><p>Once all this is configured, once you do an Enter-PSSession to a machine this is configured on. You should see a nice banner.</p><h2 id="sources">Sources</h2><ul><li><p>Special credit goes to the github user <a href="https://github.com/joeyaiello/ps-motd">joeyaiello, whose project</a> inspired me, specifically for the windows logo.</p><li><p>Microsoft Doc: https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/set-pssessionconfiguration?view=powershell-7.2</p></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/windows/'>Windows</a>, <a href='/categories/server-administration/'>Server administration</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pinned/" class="post-tag no-text-decoration" >pinned</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/winrm/" class="post-tag no-text-decoration" >winrm</a> <a href="/tags/pssession/" class="post-tag no-text-decoration" >pssession</a> <a href="/tags/pssessionconfiguration/" class="post-tag no-text-decoration" >pssessionconfiguration</a> <a href="/tags/motd/" class="post-tag no-text-decoration" >motd</a> <a href="/tags/banner/" class="post-tag no-text-decoration" >banner</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://github.com/coati-pasta/coati-pasta.github.io" data-toggle="tooltip" data-placement="top" title="Github" target="_blank" rel="noopener" aria-label="Github"> <i class="fa-fw fab fa-github"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/welcome/">Welcome</a><li><a href="/posts/windows_motd/">Windows PSSession MOTD</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/banner/">banner</a> <a class="post-tag" href="/tags/doorbell/">doorbell</a> <a class="post-tag" href="/tags/g4/">G4</a> <a class="post-tag" href="/tags/hello-world/">hello_world</a> <a class="post-tag" href="/tags/motd/">motd</a> <a class="post-tag" href="/tags/pinned/">pinned</a> <a class="post-tag" href="/tags/pssession/">pssession</a> <a class="post-tag" href="/tags/pssessionconfiguration/">pssessionconfiguration</a> <a class="post-tag" href="/tags/ubiquiti/">ubiquiti</a> <a class="post-tag" href="/tags/unifi/">unifi</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/doorbell/"><div class="card-body"> <span class="timeago small" >Dec 14, 2021<i class="unloaded">2021-12-14T17:45:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Ubiquiti Unifi G4 doorbell custom ring sound</h3><div class="text-muted small"><p> Here’s how to customize the rings sound played on your Ubiquiti Unfi Doorbell G4. At the time of writing ubiquiti does not offer any option to customize the sound played on the doorbell when it’s p...</p></div></div></a></div><div class="card"> <a href="/posts/welcome/"><div class="card-body"> <span class="timeago small" >Nov 24, 2021<i class="unloaded">2021-11-24T17:45:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Welcome</h3><div class="text-muted small"><p> Intro On this blog I would like to share projects I’m doing at home or professionally. This will go from server administration, system engineering, automation (which I’m doing in my current role) ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/welcome/" class="btn btn-outline-primary" prompt="Older"><p>Welcome</p></a> <a href="/posts/doorbell/" class="btn btn-outline-primary" prompt="Newer"><p>Ubiquiti Unifi G4 doorbell custom ring sound</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/coati-pasta">coati-pasta</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/banner/">banner</a> <a class="post-tag" href="/tags/doorbell/">doorbell</a> <a class="post-tag" href="/tags/g4/">G4</a> <a class="post-tag" href="/tags/hello-world/">hello_world</a> <a class="post-tag" href="/tags/motd/">motd</a> <a class="post-tag" href="/tags/pinned/">pinned</a> <a class="post-tag" href="/tags/pssession/">pssession</a> <a class="post-tag" href="/tags/pssessionconfiguration/">pssessionconfiguration</a> <a class="post-tag" href="/tags/ubiquiti/">ubiquiti</a> <a class="post-tag" href="/tags/unifi/">unifi</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
